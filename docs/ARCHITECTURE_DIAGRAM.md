# 🏗️ Epic Library - System Architecture Diagram

## **📊 High-Level Architecture Overview**

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                    INTERNET                                      │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              AWS CLOUDFRONT CDN                                  │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │   Static Assets │  │   React App     │  │   CSS/JS Files  │  │   Images/Icons  │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              AWS S3 STATIC HOSTING                               │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐ │
│  │                        epic-web-app-static Bucket                            │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │ │
│  │  │   index.html │  │   App.js    │  │   App.css   │  │   Assets/   │        │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘        │ │
│  └─────────────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              AWS API GATEWAY                                     │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │   /query        │  │   /upload       │  │   /books        │  │   /repo         │ │
│  │   (POST)        │  │   (POST)        │  │   (GET)         │  │   (POST)        │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              AWS LAMBDA FUNCTIONS                                │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Query Handler  │  │  Upload Handler │  │  List Books     │  │ Repo Generator  │ │
│  │  (Python)       │  │  (Python)       │  │  (Python)       │  │  (Python)       │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              AWS SERVICES LAYER                                  │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Amazon Bedrock │  │  Amazon S3      │  │  DynamoDB       │  │  AWS Cognito    │ │
│  │  (AI/ML)        │  │  (Storage)      │  │  (Database)     │  │  (Auth)         │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              EXTERNAL SERVICES                                   │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  GitHub API     │  │  Route 53       │  │  Certificate    │  │  CloudWatch     │ │
│  │  (Repo Access)  │  │  (DNS)          │  │  Manager        │  │  (Monitoring)   │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

## **🔐 Security Architecture**

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              SECURITY LAYERS                                     │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              AWS COGNITO                                         │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  User Pool      │  │  App Client     │  │  JWT Tokens     │  │  User Groups    │ │
│  │  (Authentication)│  │  (Authorization)│  │  (Session Mgmt) │  │  (Permissions)  │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              API GATEWAY SECURITY                                │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Cognito        │  │  API Keys       │  │  CORS           │  │  Rate Limiting  │ │
│  │  Authorizer      │  │  (Optional)     │  │  (CORS Policy)  │  │  (Throttling)   │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              VPC SECURITY                                        │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Private        │  │  Security       │  │  NAT Gateway    │  │  IAM Roles      │ │
│  │  Subnets        │  │  Groups         │  │  (Outbound)     │  │  (Permissions)  │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

## **🔄 Data Flow Architecture**

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              USER INTERFACE                                      │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  React App      │  │  BookQA         │  │  BookUpload     │  │  RepoUpload     │ │
│  │  (Frontend)     │  │  (Q&A)          │  │  (File Upload)  │  │  (GitHub)       │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              API GATEWAY                                         │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  /query         │  │  /upload        │  │  /books         │  │  /repo          │ │
│  │  (Question)     │  │  (File)         │  │  (List)         │  │  (GitHub URL)   │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              LAMBDA PROCESSING                                   │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Query Handler  │  │  Upload Handler │  │  List Books     │  │ Repo Generator  │ │
│  │  1. Embed       │  │  1. Process     │  │  1. Scan S3     │  │  1. Fetch Repo  │ │
│  │  2. Search      │  │  2. Chunk       │  │  2. List Files  │  │  2. Generate    │ │
│  │  3. Generate    │  │  3. Embed       │  │  3. Return      │  │  3. Store       │ │
│  │  4. Return      │  │  4. Store       │  │   Metadata      │  │  4. Index       │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              DATA STORAGE                                        │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Amazon S3      │  │  DynamoDB       │  │  Amazon Bedrock │  │  CloudWatch     │ │
│  │  (Raw Files)    │  │  (Embeddings)   │  │  (AI Models)    │  │  (Logs)         │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

## **🧠 AI/ML Architecture**

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              AI/ML PIPELINE                                      │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              INPUT PROCESSING                                    │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Text Chunking  │  │  Text Cleaning  │  │  Format         │  │  Encoding       │ │
│  │  (1000 chars)   │  │  (Normalize)    │  │  Detection      │  │  (UTF-8)        │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              AMAZON BEDROCK                                     │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Titan Embed    │  │  Titan Text     │  │  Content        │  │  Vector          │ │
│  │  (Embeddings)   │  │  (Generation)   │  │  Filtering      │  │  Search          │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              OUTPUT PROCESSING                                   │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Response       │  │  Source         │  │  Confidence     │  │  Content        │ │
│  │  Generation     │  │  Attribution    │  │  Scoring        │  │  Moderation     │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

## **📊 Database Schema**

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              DYNAMODB SCHEMA                                     │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              BOOK-EMBEDDINGS-DEV TABLE                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  chunk_id       │  │  book_title     │  │  text           │  │  embedding      │ │
│  │  (Primary Key)  │  │  (GSI Key)      │  │  (Content)      │  │  (Vector)       │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  token_count    │  │  created_at     │  │  type           │  │  metadata        │ │
│  │  (Integer)      │  │  (Timestamp)    │  │  (String)       │  │  (JSON)         │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

## **🔄 Request Flow Diagram**

```
USER REQUEST FLOW:
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   React     │───▶│  API        │───▶│  Lambda     │───▶│  Bedrock    │
│   Frontend  │    │  Gateway    │    │  Function   │    │  AI Model   │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
                                                              │
                                                              ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   DynamoDB  │◀───│  Vector     │◀───│  Embedding  │◀───│  Response   │
│   Storage   │    │  Search     │    │  Generation │    │  Processing │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

## **📁 File Upload Flow**

```
FILE UPLOAD FLOW:
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   User      │───▶│  React      │───▶│  API        │───▶│  Lambda     │
│   Upload    │    │  Frontend   │    │  Gateway    │    │  Upload     │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
                                                              │
                                                              ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   S3        │◀───│  Text       │◀───│  Chunking   │◀───│  File       │
│   Storage   │    │  Processing │    │  Algorithm  │    │  Processing │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
                                                              │
                                                              ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   DynamoDB  │◀───│  Embedding  │◀───│  Bedrock    │◀───│  Chunk      │
│   Index     │    │  Storage    │    │  Titan      │    │  Generation │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

## **🔧 Infrastructure Components**

```
INFRASTRUCTURE STACK:
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              CLOUDFORMATION STACK                                │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              COMPUTE LAYER                                       │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Lambda         │  │  Lambda         │  │  Lambda         │  │  Lambda         │ │
│  │  Execution      │  │  Layers         │  │  Permissions    │  │  Monitoring     │ │
│  │  Role           │  │  (Dependencies) │  │  (IAM)          │  │  (CloudWatch)   │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              STORAGE LAYER                                       │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  S3 Bucket      │  │  DynamoDB       │  │  CloudWatch     │  │  Route 53       │ │
│  │  (epic-s3-*)    │  │  (book-embeddings)│  │  (Logs)        │  │  (DNS)          │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

## **🌐 Network Architecture**

```
NETWORK SECURITY:
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              VPC ARCHITECTURE                                    │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              PUBLIC SUBNETS                                      │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  NAT Gateway    │  │  Internet       │  │  Route Table    │  │  Security       │ │
│  │  (Outbound)     │  │  Gateway        │  │  (Public)       │  │  Groups         │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              PRIVATE SUBNETS                                     │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Lambda         │  │  Lambda         │  │  Lambda         │  │  Lambda         │ │
│  │  Functions      │  │  Functions      │  │  Functions      │  │  Functions      │ │
│  │  (Private)      │  │  (Private)      │  │  (Private)      │  │  (Private)      │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

## **📊 Monitoring & Observability**

```
MONITORING STACK:
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              OBSERVABILITY LAYER                                 │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              CLOUDWATCH                                          │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Lambda Logs    │  │  API Gateway    │  │  Custom         │  │  Dashboards     │ │
│  │  (Application)  │  │  Logs           │  │  Metrics        │  │  (Monitoring)   │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              ALERTING                                            │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Error          │  │  Performance    │  │  Security       │  │  Cost           │ │
│  │  Alerts         │  │  Alerts         │  │  Alerts         │  │  Alerts         │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

## **🔐 Security Architecture Details**

```
SECURITY LAYERS:
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              SECURITY STACK                                      │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              AUTHENTICATION                                      │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  AWS Cognito    │  │  JWT Tokens     │  │  User Pools     │  │  App Clients    │ │
│  │  (User Auth)    │  │  (Session)      │  │  (Identity)     │  │  (OAuth)        │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              AUTHORIZATION                                       │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  IAM Roles      │  │  API Keys       │  │  CORS Policy    │  │  Rate Limiting  │ │
│  │  (Permissions)  │  │  (Optional)     │  │  (Cross-Origin) │  │  (Throttling)   │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────┬───────────────────────────────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              DATA PROTECTION                                     │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  Encryption     │  │  VPC Isolation  │  │  Security       │  │  Audit          │ │
│  │  (At Rest)      │  │  (Network)      │  │  Groups         │  │  Logging        │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

This architecture diagram provides a comprehensive view of the Epic Library system, showing the relationships between components, data flow, security layers, and infrastructure design. The system follows AWS best practices with a serverless, scalable, and secure architecture. 